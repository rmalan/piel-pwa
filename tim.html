<!DOCTYPE html>
<html>
	<head>
		<!--Import Google Icon Font-->
		<link
			href="https://fonts.googleapis.com/icon?family=Material+Icons"
			rel="stylesheet"
		/>
		<!--Import materialize.css-->
		<link
			type="text/css"
			rel="stylesheet"
			href="css/materialize.min.css"
			media="screen,projection"
		/>
		<link type="text/css" rel="stylesheet" href="css/style.css" />

		<!--Let browser know website is optimized for mobile-->
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<link rel="shortcut icon" href="images/favicon.ico" />

		<title>PieL-PWA | Semua Tentang Premier League</title>
	</head>

	<body>
		<nav class="purple darken-4">
			<div class="nav-wrapper container">
				<a href="#!" class="brand-logo">PieL</a>
				<a href="#" data-target="mobile-demo" class="sidenav-trigger">
					<i class="material-icons">menu</i>
				</a>
				<ul class="right hide-on-med-and-down">
					<li><a href="index.html">Beranda</a></li>
					<li><a href="tim.html">Tim</a></li>
					<li><a href="klasemen.html">Klasemen</a></li>
					<li><a href="favorit.html">Favorit</a></li>
				</ul>

				<ul class="sidenav" id="mobile-demo">
					<li><a href="index.html">Beranda</a></li>
					<li><a href="tim.html">Tim</a></li>
					<li><a href="klasemen.html">Klasemen</a></li>
					<li><a href="favorit.html">Favorit</a></li>
				</ul>
			</div>
		</nav>

		<div class="container" id="body-content">
			<h1 class="center align">
				Tim-Tim Premier League
			</h1>
			<div class="divider"></div>
			<div class="row">
				<div class="teams-list">
					<div id="preload"></div>
					<div id="pl-teams"></div>
				</div>
			</div>
		</div>

		<footer class="page-footer purple darken-4">
			<div class="footer-copyright">
				<div class="container">
					2020 &#169; PieL
					<a class="grey-text text-lighten-4 right" href="#!"
						>GitHub</a
					>
				</div>
			</div>
		</footer>

		<!--JavaScript at end of body for optimized loading-->
		<script type="text/javascript" src="js/materialize.min.js"></script>
		<script type="text/javascript" src="js/script.js"></script>
		<script>
			let base_url = "https://api.football-data.org/v2/";

			// Blok kode yang akan di panggil jika fetch berhasil
			function status(response) {
				if (response.status !== 200) {
					console.log("Error : " + response.status);

					// Method reject() akan membuat blok catch terpanggil
					return Promise.reject(new Error(response.statusText));
				} else {
					// Mengubah suatu objek menjadi Promise agar bisa "di-then-kan"
					return Promise.resolve(response);
				}
			}

			// Blok kode untuk memparsing json menjadi array JavaScript
			function json(response) {
				return response.json();
			}

			// Blok kode untuk meng-handle kesalahan di blok catch
			function error(error) {
				// Parameter error berasal dari Promise.reject()
				console.log("Error : " + error);
			}

			// Block kode utk menampilkan pre-oad sebelum data dimuat
			function preloader() {
				let preload = `
                    <div class="center-align">
						<div class="preloader-wrapper big active">
							<div class="spinner-layer spinner-blue-only">
								<div class="circle-clipper left">
									<div class="circle"></div>
								</div>
								<div class="gap-patch">
									<div class="circle"></div>
								</div>
								<div class="circle-clipper right">
									<div class="circle"></div>
								</div>
							</div>
						</div>
					</div>
                `;

				// Menyisipkan preload
				document.getElementById("preload").innerHTML = preload;
			}

			// Blok kode untuk melakukan request data json
			function getTeams() {
				preloader();

				fetch(base_url + "competitions/2021/teams", {
					method: "GET",
					headers: new Headers({
						"X-Auth-Token": "f93b4249e66a4297bf2fd1af2a8d7e6a",
					}),
				})
					.then(status)
					.then(json)
					.then(function (data) {
						// Menyusun komponen tim
						let teams = "";
						data.teams.forEach((team) => {
							teams += `
								<div class="col s12 m6 l4">
                                    <div class="card">
                                        <div class="card-image team--logo valign-wrapper">
                                            <img src="${team.crestUrl}" />
                                            <a class="btn-floating halfway-fab waves-effect waves-light red accent-3 saved">
                                                <i class="material-icons">bookmark_border</i>
                                            </a>
                                        </div>
                                        <div class="card-content team--content">
                                            <a href="${team.website}" class="card-title blue-text truncate" target="_blank" >${team.name}</a>
                                            <p class="">${team.venue}</p>
                                        </div>
                                    </div>
                                </div>
							`;
						});
						// Sisipkan komponen tim ke dalam elemen dengan id #pl-teams
						document.getElementById("pl-teams").innerHTML = teams;

						// Menghilangkan preload
						document.getElementById("preload").innerHTML = "";
					})
					.catch(error);
			}

			document.addEventListener("DOMContentLoaded", function () {
				getTeams();
			});
		</script>
	</body>
</html>
